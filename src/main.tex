\documentclass[12pt,a4paper,zihao=-4,AutoFakeBold,AutoFakeSlant]{ctexart}

\usepackage{iftex}
\usepackage{xeCJK}
\usepackage{gbt7714}
\usepackage{amsmath,amsthm,amssymb,amsfonts,mathrsfs,mathtools}
\usepackage{graphicx,caption,float}
\usepackage{geometry,fancyhdr}
\usepackage{appendix}
\usepackage{enumerate}
\usepackage{tablefootnote}
\usepackage{tocloft}
\usepackage[colorlinks,linkcolor=black,anchorcolor=black,citecolor=black]{hyperref}
\usepackage[symbol]{footmisc}
\usepackage{cleveref}
\usepackage{fontspec}
\usepackage{setspace}
\usepackage{framed}
\usepackage{mdframed}
\usepackage{array}
\usepackage{xlop}
\usepackage{tabularx}
\usepackage{color,xcolor}
\usepackage[boxed,ruled,lined,linesnumbered]{algorithm2e}
\usepackage{algorithmic}
\usepackage{listings,lstautogobble}
\usepackage{minted}

% 设置行间距
\linespread{1.5}

% 页面格式
\geometry{left=3cm,right=3cm,top=2.5cm,bottom=2.5cm}

% 目录和正文的页眉与页脚
\fancypagestyle{plain}
 {\fancyhf{}
  \fancyfoot[C]{\zihao{-5}\thepage}
  \renewcommand\headrulewidth{0pt}
  \renewcommand\footrulewidth{0pt}}
\fancypagestyle{body}
 {\fancyhf{}
  \fancyfoot[C]{\zihao{-5}\thepage}
  \fancyhead{\centering\zihao{-5}山东大学本科毕业论文（设计）}
  \renewcommand\headrulewidth{0.6pt}
  \renewcommand\footrulewidth{0pt}}

% 参考文献格式
\bibliographystyle{gbt7714-numerical}
\setlength{\bibsep}{0em}
\renewcommand*{\bibfont}{\songti\zihao{5}}
\setmainfont{Times New Roman}

\ctexset{
  section={
    format+=\heiti\zihao{3}\bfseries,
    beforeskip=0.8\baselineskip,
    afterskip=0.5\baselineskip,
  },
  subsection={
    format=\heiti\zihao{4}\bfseries,
    beforeskip=0.5\baselineskip,
    afterskip=0.5\baselineskip,
  },
  subsubsection={
    format=\heiti\zihao{-4}\bfseries,
    beforeskip=0.5\baselineskip,
    afterskip=0.5\baselineskip,
  },
  autoindent=true,
  contentsname={\hfill{\heiti\zihao{-2}\bfseries 目\qquad 录}\hfill},
  bibname={\hfill{\heiti\zihao{-2}\bfseries 参考文献}\hfill},
  appendixname={\hfill{\heiti\zihao{-2}\bfseries 附\qquad 录}\hfill},
}

% 设置图片和表格编号的格式
\renewcommand{\thefigure}{\arabic{section}.\arabic{figure}}
\renewcommand{\thetable}{\arabic{section}-\arabic{table}}
\DeclareCaptionLabelSeparator{quad}{\quad}
\DeclareCaptionFont{labelfont}{\songti\zihao{5}\bfseries}
\captionsetup{labelsep=quad,font=labelfont}

% 设置公式编号样式
% 如果想要全文统一编序，而非每章单独编序，则注释掉下面一行
\renewcommand{\theequation}{\arabic{section}-\arabic{equation}}

\begin{document}

\pagestyle{empty}

\clearpage\input{"cover/cover.tex"}

\clearpage\input{"abstractC/abstractC.tex"}
\clearpage\input{"abstractE/abstractE.tex"}

\clearpage
\setcounter{page}{1}
\pagenumbering{Roman}
\pagestyle{plain}

\clearpage
\tableofcontents

\clearpage
\setcounter{page}{1}
\pagenumbering{arabic}
\pagestyle{body}

\clearpage\input{"body/1.tex"}
\clearpage\input{"body/2.tex"}
% \clearpage\input{"body/3.tex"}
% \clearpage\input{"body/4.tex"}
% ...

\clearpage
\phantomsection
\addcontentsline{toc}{section}{参考文献}
\nocite{*}
\begin{spacing}{1}
  \bibliography{ref}
\end{spacing}

\clearpage\input{"acknowledge/acknowledge.tex"}

\clearpage\input{"appendix/appendix.tex"}

\end{document}
