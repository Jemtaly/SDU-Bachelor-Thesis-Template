\documentclass[12pt,a4paper,zihao=-4,AutoFakeBold,AutoFakeSlant]{ctexart}

\usepackage{iftex}
\usepackage{xeCJK}
\usepackage{gbt7714}
\usepackage{amsmath,amsthm,amssymb,amsfonts,mathrsfs,mathtools}
\usepackage{graphicx,caption,float}
\usepackage{geometry,fancyhdr}
\usepackage{appendix}
\usepackage{enumerate}
\usepackage{tablefootnote}
\usepackage{tocloft}
\usepackage[colorlinks,linkcolor=black,anchorcolor=black,citecolor=black]{hyperref}
\usepackage[symbol]{footmisc}
\usepackage{cleveref}
\usepackage{fontspec}
\usepackage{setspace}
\usepackage{framed}
\usepackage{mdframed}
\usepackage{array}
\usepackage{xlop}
\usepackage{tabularx}
\usepackage{color,xcolor}
\usepackage[boxed,ruled,lined,linesnumbered]{algorithm2e}
\usepackage{algorithmic}
\usepackage{listings,lstautogobble}
\usepackage{minted}

% 设置行间距
\linespread{1.5}

% 页面格式
\geometry{left=3cm,right=3cm,top=2.5cm,bottom=2.5cm}

% 目录和正文的页眉与页脚
\fancypagestyle{plain}
 {\fancyhf{}
  \fancyfoot[C]{\zihao{-5}\thepage}
  \renewcommand\headrulewidth{0pt}
  \renewcommand\footrulewidth{0pt}}
\fancypagestyle{body}
 {\fancyhf{}
  \fancyfoot[C]{\zihao{-5}\thepage}
  \fancyhead{\centering\zihao{-5}山东大学本科毕业论文（设计）}
  \renewcommand\headrulewidth{0.6pt}
  \renewcommand\footrulewidth{0pt}}

% 参考文献格式
\bibliographystyle{gbt7714-numerical}
\setlength{\bibsep}{0em}
\renewcommand*{\bibfont}{\zihao{5}\songti}
\setmainfont{Times New Roman}

\ctexset{
  section={
    format+=\heiti\zihao{3}\bfseries,
    beforeskip=0.8\baselineskip,
    afterskip=0.5\baselineskip,
  },
  subsection={
    format=\heiti\zihao{4}\bfseries,
    beforeskip=0.5\baselineskip,
    afterskip=0.5\baselineskip,
  },
  subsubsection={
    format=\heiti\zihao{-4}\bfseries,
    beforeskip=0.5\baselineskip,
    afterskip=0.5\baselineskip,
  },
  autoindent=true,
  contentsname={\hfill\textbf{\heiti\zihao{-2}目\qquad 录}\hfill},
  bibname={\hfill\heiti\zihao{-2}{参考文献}\hfill},
  appendixname={\hfill\textbf{\heiti\zihao{-2}附\qquad 录}\hfill},
}

% 设置片和表格编号的格式
\renewcommand{\thefigure}{\arabic{section}.\arabic{figure}}
\renewcommand{\thetable}{\arabic{section}-\arabic{table}}
\DeclareCaptionLabelSeparator{quad}{\quad}
\captionsetup{labelsep=quad}

\begin{document}

\pagestyle{empty}

\newpage\input{"cover/cover"}

\begin{sloppypar}
  \newpage\input{"abstractC/abstractC"}
  \newpage\input{"abstractE/abstractE"}
\end{sloppypar}

\clearpage
\setcounter{page}{1}
\pagenumbering{Roman}
\pagestyle{plain}

\newpage
\tableofcontents

\clearpage
\setcounter{page}{1}
\pagenumbering{arabic}
\pagestyle{body}

\begin{sloppypar}
  \newpage\input{"body/1.tex"}
  \newpage\input{"body/2.tex"}
  % \newpage\input{"body/3.tex"}
  % \newpage\input{"body/4.tex"}
  % \newpage\input{"body/5.tex"}
\end{sloppypar}

\newpage
\addcontentsline{toc}{section}{参考文献}
\nocite{*}
\begin{spacing}{1}
  \bibliography{ref}
\end{spacing}

\begin{sloppypar}
  \newpage\input{"acknowledge/acknowledge"}
  \newpage\input{"appendix/appendix"}
\end{sloppypar}

\end{document}
